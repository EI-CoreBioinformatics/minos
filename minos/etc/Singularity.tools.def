Bootstrap: docker
From: continuumio/miniconda3

%test
	export PATH="/usr/local/bin:$PATH:/usr/local/conda/bin/"
	python --version
%environment
	export PYTHONDONTWRITEBYTECODE=true
%post

	conda update conda -n base -y && conda install -c conda-forge -n base -y mamba pip git gcc gxx wget bzip2 gzip tar make
	mamba install -c conda-forge -c bioconda -y asn1crypto kallisto=0.44.0 diamond=0.9.34 bedtools=2.29.2 blast=2.9.0 biopython prinseq numpy genometools-genometools gffread=0.11.6 seqkit=2.1.0

	mkdir -p /opt/software
	cd /opt/software

	git clone https://github.com/EI-CoreBioinformatics/CPC2 CPC2
	cd CPC2
	python3 setup.py bdist_wheel && pip3 install dist/*whl
        CPC2 -h

	mamba clean --all --yes
